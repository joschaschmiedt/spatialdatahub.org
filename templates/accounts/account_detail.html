{% extends 'base.html' %}
{% load staticfiles %}

{% block title %}{{ account.user }}{% endblock title %}

{% block css %}
<style>

  #datasetsContainer {
    height: 50em;
    float: left;
  }

  #datasets-list {
    overflow-y: auto;
    height: 41em;
  }

  .breadcrumb {
    background-color: white;
  }

  #mainContainer {
    overflow-y: auto;
    overflow-x: hidden;
    float: right;
  }

  #mapid {
    height: 50em;
    margin-bottom: 10px;
  }

</style>
<link rel='stylesheet' href='{% static "css/dashboard.css" %}'/>
<link rel='stylesheet' href='https://unpkg.com/leaflet@1.0.3/dist/leaflet.css' />

{% endblock css %}

{% block content %}

<div class='container'>

  <ol class='breadcrumb'>
    <li><a href='{% url "portal" %}' >*</a></li>
    <li><a id='account_link' value={{ account.account_slug }} href='{{ account.get_absolute_url }}' >{{ account.user }}</a></li>
    <li id='breadcrumbContainer'></li>
  </ol>

  <div class='row' id='crud'>
    <div class='col-xs-12'>
      <h3>
        <a href='{% url "datasets:new_dataset" account.account_slug %}'>
          Add New Dataset
        </a>
      </h3>
    </div>
  </div>

  <div class='row' id='filters'>
    <div class='col-xs-12'>
    </div>
  </div>


  <div class='row' id='main'>
    <div class='col-xs-12 col-md-8 col-lg-9' id='mainContainer'> <!-- how do i make this container scrollable -->
      <div id='mapid'></div>
      <div id='dataset_detail'></div>
    </div>

    <!-- I need to set this up so it loads by ajax -->
    <div class='col-xs-12 col-md-4 col-lg-3' id='datasetsContainer'>
      <ol class='nav nav-pills nav-stacked'>
          <li>
            <form action='.' method='GET'>
              <input class='form-control' name='q' type='text' placeholder="Search Datasets">
            </form>
          <li>
      </ol>
      <ol id='datasets-list' class='nav nav-pills nav-stacked'>
        <!-- about to get real hacky here -->
        {% if dataset_list %}
          {% for dataset in dataset_list %}
            {% if dataset.dataset_password %}
              <li class=''>
                <a name='dataset' id={{ dataset.ext }} value={{ dataset.pk }} href='#'
                  link='{{ dataset.get_absolute_url }}'>
                  {{ dataset.title }}
                </a>
              </li>
            {% else %}
              <li class=''>
                <a name='dataset' id={{ dataset.ext }} value={{ dataset.pk }} href='#'
                  link='{{ dataset.get_absolute_url }}' url={{ dataset.url }}>
                  {{ dataset.title }}
                </a>
              </li>
            {% endif %}
          {% endfor %}
        {% else %}
          <li><a href='#'>There are no datasets available</a></li>
        {% endif %}
      </ol>
    </div>
  </div>


    </div>


{% endblock content %}

{% block js %}
<script src='https://unpkg.com/leaflet@1.0.3/dist/leaflet.js'></script>
<script src='//api.tiles.mapbox.com/mapbox.js/plugins/leaflet-omnivore/v0.3.1/leaflet-omnivore.min.js'></script>

<script src='{% static "js/index.js" %}'></script>
<script src='{% static "js/indexMap.js" %}'></script>
<script src='{% static "js/initMap.js" %}'></script>
<script src='{% static "js/accounts/accountDetail.js" %}'></script>
{% endblock js %}

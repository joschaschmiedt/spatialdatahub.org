{% extends "base.html" %}
{% load staticfiles %}

<!--

there is something wrong with this page's divs. I think that there is an unpaired closing div somewhere.


-->

{% block title %}{{ dataset.title }}{% endblock title %}

{% block css %}

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />

<style>

  #mapid {
    height: 45em;
    margin-bottom: 1em;
  }

</style>

<!-- Marker Cluster CSS -->
<!--
<link rel='stylesheet' href='https://unpkg.com/leaflet.markercluster@1.0.0/dist/MarkerCluster.css' />
<link rel='stylesheet' href='https://unpkg.com/leaflet.markercluster@1.0.0/dist/MarkerCluster.Default.css' />
-->
<!-- End Marker Cluster CSS -->


{% endblock css %}

{% block breadcrumbs %}
/ <a href="{{ account.get_absolute_url }}">{{ account.user }}</a>
/ <a href="{{ dataset.get_absolute_url }}">{{ dataset.title }}</a>
{% endblock breadcrumbs %}

{% block content %}

  <div class="row">
    <p><h4><b>Title:</b> {{ dataset.title }}</h4></p>
    <p><b>Author:</b> {{ dataset.author }}</p>
    <p><b>Description:</b> {{ dataset.description }}</p>
    {% if keyword_list %}
      <p><b>Keywords:</b>
        {% for keyword in keyword_list %}
          <a href="{{ keyword.get_absolute_url }}">{{ keyword.keyword }}</a>
        {% endfor %}
      </p>
    {% endif %}
    <h4>
      <a href="{% url 'datasets:add_keyword_to_dataset' account.account_slug dataset.dataset_slug dataset.pk %}">
        Add a keyword to {{ dataset.title }}
      </a>
    {% if keyword_list %}
      or <a href="{% url 'datasets:remove_keyword_from_dataset' account.account_slug dataset.dataset_slug dataset.pk %}">
        Remove a keyword from {{ dataset.title }}
      </a>
    </h4>
    {% endif %}
  </div>
  <hr class="divider">

    <!-- info divs -->
    <!-- There must be a better way to do this-->

    <div id="dataset_pk" value="{{ dataset.pk }}"></div>
    <div id="dataset_ext" value="{{ dataset.ext }}"></div>
    {% if not dataset.dataset_password %}
      <div id="dataset_url" url="{{ dataset.url }}"></div>
    {% else %}
      <div id="dataset_url"></div>
    {% endif %}

    <!-- info divs -->

<!-- These should be inline links -->
<!-- These should only be seen by the person who created the dataset -->
  <div class="row">
    <p>
      <a href="{% url 'datasets:dataset_update' account.account_slug dataset.dataset_slug dataset.pk %}">
        Update {{ dataset.title }}
      </a>
    </p>
    <p>
      <a href="{% url 'datasets:dataset_update_auth' account.account_slug dataset.dataset_slug dataset.pk %}">
        Update {{ dataset.title }} authentication details
      </a>
    </p>
    <p>
      <a href="{% url 'datasets:dataset_remove' account.account_slug dataset.dataset_slug dataset.pk %}">
        Remove {{ dataset.title }}
      </a>
    </p>
  </div>
  <hr>

  <div class="row">
    <p><b>Number of dataset features: </b><span id="feature_count"></span></p>
  </div>
  <hr>



<!-- MAP -->
  <div class"custom-popup" id="mapid"></div>
<!-- END MAP -->

{% endblock content %}

{% block js %}

<script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
<script src="//api.tiles.mapbox.com/mapbox.js/plugins/leaflet-omnivore/v0.3.1/leaflet-omnivore.min.js"></script>
<script src="https://npmcdn.com/@turf/turf/turf.min.js"></script>

<script src="{% static 'js/indexMap.js' %}"></script>
<script src="{% static 'js/initMap.js' %}"></script>
<script src="{% static 'js/datasets/detailView.js' %}"></script>

{% endblock js %}

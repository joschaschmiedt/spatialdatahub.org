{% extends "base.html" %}
{% load staticfiles %}

{% block head_title %}{{ dataset.title }}{% endblock head_title %}
{% block additional_css %}
  <style>

    #mapid {
      height: 65%;
    }

    #main_map {
      padding-bottom: 100px;
    }

  </style>
{% endblock additional_css %}

{% block content %}
{% include "base_map_css.html" %}

<div class="container-fluid">

<!-- account / dataset links -->
  <div class="row">
    <h5 class="col-xs-12">
      <a href="{% url 'portal' %}" >*</a> /
      <a href="{{ account.get_absolute_url }}" >{{ account.user }}</a> /
      <a href="{{ dataset.get_absolute_url }}" >{{ dataset.title }}</a>
    </h5>
  </div>
  <hr class="divider">
<!-- end account / dataset links -->


  <!-- Dataset Info -->
  <div class="row">
    <div class="col-12 col-xs-12" id="meta_data">
      <p><b>Account:</b> <a href="{{ account.get_absolute_url }}">{{ account }}</a></p>
      <p><b>Affiliation:</b> {{ account.affiliation }}</p>
    <hr class="divider">
      <p><b>Dataset Title:</b> {{ dataset.title }}</p>
      <p><b>Author:</b> {{ dataset.author }}</p> 
      <p><b>Dataset Visible to Public:</b> {{ dataset.public_access }}</p>
      <p><b>Dataset Description:</b> {{ dataset.description }}</p>
      <p><b>Date Created:</b> {{ dataset.date_added }}</p>

      <!-- Special Javascript Created Elements -->
      <p><b>Number of dataset features:</b><span id="feature_count"></span></p>

      <p>NOT DONE YET <b>Select property to filter by:</b>
        <span>
          <select id="feature_selector">
          </select>
        </span>
      </p>

      <p>
        <b>Latitude:</b>
        <input id="lat_min_input" type="text" placeholder="minimum" />
        <input id="lat_max_input" type="text" placeholder="maximum" />
      </p>
      <p>
        <b>Longitude:</b>
        <input id="lng_min_input" type="text" placeholder="minimum" />
        <input id="lng_max_input" type="text" placeholder="maximum" />
      </p>
			<p>
				<input id='submit_values_button' type='submit' value='Submit'>
				<input id='reset_values_button' type='submit' value='Reset Points'>
			</p>

      <!-- End Special Javascript Created Elements -->
    </div>
  </div>
  <hr class="divider">
  <!-- End Dataset Info -->

  <!-- Links to modify the database or get back to the map list -->
  <div class="row">
    <div class="col-12 col-xs-12" id="modifier_links">
      <a href="{% url 'datasets:new_dataset' account.account_slug %}" class="btn btn-success">
        Add new dataset 
      </a>
      <a href="{% url 'datasets:dataset_update' account.account_slug dataset.dataset_slug dataset.pk %}"
        class="btn btn-warning">Update this dataset</a>
      <a href="{% url 'datasets:dataset_remove' account.account_slug dataset.dataset_slug dataset.pk %}"
        class="btn btn-danger">Remove this dataset</a>
      <a href="{{ account.get_absolute_url }}" class="btn btn-info">
        Back to {{ account.user }} map list
      </a>
      <a href="{% url 'accounts:account_portal' account.account_slug %}" class="btn btn-primary">
        Back to {{ account.user }} portal
      </a>
    </div>
  </div>
  <hr class="divider">
  <!-- End Links to modify the database or get back to the map list -->

	<!--
		Can I pass in variables alone? Why can't I pass them in as empty divs?
		I am going to do that until I think of a better way.
	-->
  <div id="dataset_pk" value="{{ dataset.pk }}"></div>
  <div id="dataset_ext" value="{{ dataset.ext }}"></div>


  <!-- Map and Background Choices -->
  <div class="row">
    <div class="col-12 col-xs-12" id="main_map">
      <div id="mapid">
      </div>
    </div>
  </div>
  <!-- End Map and Background Choices -->

</div>

{% include "base_map_js.html" %}
{% endblock content %}

  <!-- why am i doing this in a block? -->
{% block js %}

<!-- if file is kml include the togeojson.js here and use it with kml files -->
{% if dataset.ext == 'kml' %}
  <script type="text/javascript" src="{% static 'leaflet_packages/togeojson.js' %}"></script>
{% endif %}

<!-- if file is csv include csv2geojson.js here -->
{% if dataset.ext == 'csv' %}
  <script type="text/javascript" src="https://npmcdn.com/csv2geojson@5.0.2/csv2geojson.js"></script>
{% endif %}

  <script type="text/javascript" src="{% static 'js/base.js' %}"></script>
  <script type="text/javascript" src="{% static 'js/base_map.js' %}"></script>
  <script type="text/javascript" src="{% static 'js/datasets/detailView.js' %}"></script>
{% endblock js %}

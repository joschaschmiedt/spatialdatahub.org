{% extends 'base.html' %}
{% load staticfiles %}

{% block head_title %}
  GIS Portal
{% endblock head_title %}

{% block content %}

<div class="container-fluid">
  <div class="row">
<!-- Dataset Choices Sidebar NEW -->
    <div class="col-xs-6 col-sm-5 col-md-3 sidebar-offcanvas" id="sidebar">

<!-- This form needs to be reworked -->
      <form action="" method="get">
        <input type="text" class="form-control text-center" name="q" placeholder="Search Datasets by Title">
        <a role="button" class="btn btn-default btn-block" href="{% url 'datasets:portal' %}">Show All</a>
        <button class="btn btn-default btn-block" id="clear data" onClick="clearAllLayers();">
          Clear Map
        </button>
      </form>

<!-- List of maps -->
      <div>
        <ul class="nav nav-sidebar">
          <li><b>Map Name <div class="pull-right">Meta Data</div></b></li>
        {% if dataset_list %}
          {% for dataset in dataset_list %}
            {% if dataset.fields.json %}
              <li>
                <a href="#" onClick="getJsonFromLocal({{ dataset.fields.json }});">
                  {{ dataset.fields.title }}
                </a> 
                <a href="{% url 'datasets:dataset_detail' dataset.fields.slug dataset.pk %}" >
                  <i class="fa fa-newspaper-o fa-pull-right fa-border" aria-hidden="true"></i>
                </a>
              </li>
            {% else %}
              <li>
                <a href="#" onClick="getJsonFromUrl('{{ dataset.fields.url }}');">
                  {{ dataset.fields.title }}
                </a>
                <a href="{% url 'datasets:dataset_detail' dataset.fields.slug dataset.pk %}" >
                  <i class="fa fa-newspaper-o fa-pull-right fa-border" aria-hidden="true"></i>
                </a>
              </li>
            {% endif %} 
          {% endfor %}
        {% else %}
          <h4>There are no datasets available</h4>
        {% endif %}
      </div>
      </ul>
    </div>


<!-- Map and Background Choices -->
    <div class="col-12 col-xs-6 col-sm-7 col-md-9" role="main">
      <div id="mapid">
      </div>
    </div>
<!-- End Map and Background Choices -->

  </div>
</div>

<script type="text/javascript" src="{% static 'dummy_data/us-states.js' %}"></script>
<script type="text/javascript" src="{% static 'datasets/js/portal_map.js' %}"></script> 
{% endblock content %}
